{"ast":null,"code":"import React from \"react\";\nimport '../butterclient';\nimport Butter from 'buttercms';\nconst butter = Butter('2fa7babaa7064c23b2cb90171957b2add0333e77');\n\nclass StoreModel extends React.Component {\n  constructor(props) {\n    super();\n    this.subscribers = [];\n    this.state = {\n      basket: props.basket\n    };\n    this.initialbasket = this.getproducts();\n  }\n\n  getproducts() {\n    let pagesToCheck = [\"shop\"];\n    console.log(this.getPageInformation(\"shop\"));\n    debugger;\n    return [...pagesToCheck.forEach(toCheck => {\n      console.log(toCheck);\n      return [...this.getPageInformation(toCheck).then(v => v.data.data.fields.subcategory.product_in_subcategory).catch(e => {\n        console.log(e);\n        this.clearBasket();\n      }).finally(i => {\n        console.log(i);\n      })];\n    })];\n  }\n\n  addObserver(callback) {\n    this.subscribers.push(callback);\n  }\n\n  removeObserver(callback) {\n    callback = this.subscribers.filter(o => o !== callback);\n  }\n\n  notifyObservers(whatHappened) {\n    this.subscribers.forEach(function (callback) {\n      callback(whatHappened);\n    });\n  }\n\n  addToBasket(prod, size = \"n/a\", amount = 1) {\n    let productthatexisted = this.state.basket.filter(produc => deepEqual(produc.prod, prod) && produc.sizeselected === size);\n    let bask = this.state.basket.filter(produc => !(deepEqual(produc.prod, prod) && produc.sizeselected === size));\n    let productObject = {\n      prod,\n      sizeselected: size,\n      amountorderd: amount\n    };\n\n    if (productthatexisted.length !== 0) {\n      let combinedamount = amount + productthatexisted[0].amountorderd;\n      productObject = {\n        prod,\n        sizeselected: size,\n        amountorderd: combinedamount\n      };\n    }\n\n    this.state.basket = [...bask, productObject];\n    localStorage.setItem(\"The_coolest_store\", JSON.stringify({\n      basket: [...this.state.basket]\n    }));\n    this.notifyObservers({\n      added: productObject\n    });\n  }\n\n  removeFromBasket(prod, size) {\n    let bask = this.state.basket.filter(produc => !(deepEqual(produc.prod, prod) && produc.sizeselected === size));\n    this.state.basket = [...bask];\n    localStorage.setItem(\"The_coolest_store\", JSON.stringify({\n      basket: [...this.state.basket]\n    }));\n    this.notifyObservers({\n      removed: prod\n    });\n  }\n\n  addQuantatieOfProduct(prod, size, change) {\n    let productthatexisted = this.state.basket.filter(produc => deepEqual(produc.prod, prod) && produc.sizeselected === size);\n    let bask = this.state.basket.filter(produc => !(deepEqual(produc.prod, prod) && produc.sizeselected === size));\n    let productObject = {\n      prod,\n      sizeselected: size,\n      amountorderd: 1\n    };\n    let combinedamount = 1;\n\n    if (productthatexisted.length !== 0) {\n      combinedamount = productthatexisted[0].amountorderd + change;\n\n      if (combinedamount <= 1) {\n        combinedamount = 1;\n      }\n\n      productObject = {\n        prod,\n        sizeselected: size,\n        amountorderd: combinedamount\n      };\n    }\n\n    this.state.basket = [...bask, productObject];\n    localStorage.setItem(\"The_coolest_store\", JSON.stringify({\n      basket: [...this.state.basket]\n    }));\n    this.notifyObservers({\n      changed: prod\n    });\n  }\n\n  clearBasket() {\n    this.state.basket = [];\n    console.log(this.state);\n    localStorage.setItem(\"The_coolest_store\", JSON.stringify({\n      basket: []\n    }));\n  }\n\n  getTotalBasketprice() {\n    let basket = this.getBasket();\n    let price = basket.reduce((a, product) => a += product.prod.product_price * product.amountorderd, 0);\n    return Math.round((price + Number.EPSILON) * 100) / 100;\n  }\n\n  isItemInBasket(prod, size) {\n    let productthatexisted = this.state.basket.filter(produc => deepEqual(produc.prod, prod) && produc.sizeselected === size);\n\n    if (productthatexisted.length !== 0) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  async getPageInformation(link) {\n    return await butter.page.retrieve('*', '' + link + '');\n  }\n\n  getBasket() {\n    let apiProducts = [...this.initialbasket];\n    let correctProducts = [];\n    let basket = [...this.state.basket];\n    basket.forEach(productinbasket => {\n      console.log(productinbasket.prod);\n      console.log(correctProducts);\n      correctProducts = [...correctProducts, {\n        sizeselected: productinbasket.sizeselected,\n        amountorderd: productinbasket.amountorderd,\n        prod: apiProducts.find(collecteditem => !deepEqual(productinbasket.prod, collecteditem))\n      }];\n    });\n    let sortedBask = basket.sort((a, b) => {\n      if (a.prod.product_name > b.prod.product_name) {\n        return +1;\n      }\n\n      if (a.prod.product_name < b.prod.product_name) {\n        return -1;\n      } else {\n        return 0;\n      }\n    });\n    return sortedBask;\n  }\n\n  getBasketItemNumber() {\n    return this.state.basket.length;\n  }\n\n}\n\nconst modelString = localStorage.getItem(\"The_coolest_store\");\nlet modelObject = JSON.parse(modelString);\nmodelObject ? console.log(\"User data detected\") : modelObject = {\n  basket: []\n};\nconst storeModel = new StoreModel(modelObject);\nexport default storeModel;\n\nfunction deepEqual(object1, object2) {\n  const keys1 = Object.keys(object1);\n  const keys2 = Object.keys(object2);\n\n  if (keys1.length !== keys2.length) {\n    return false;\n  }\n\n  for (const key of keys1) {\n    const val1 = object1[key];\n    const val2 = object2[key];\n    const areObjects = isObject(val1) && isObject(val2);\n\n    if (areObjects && !deepEqual(val1, val2) || !areObjects && val1 !== val2) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isObject(object) {\n  return object != null && typeof object === 'object';\n}","map":{"version":3,"sources":["/Users/simonsundin/Documents/GitHub/projekt_gr-n/app/src/model_more/model.js"],"names":["React","Butter","butter","StoreModel","Component","constructor","props","subscribers","state","basket","initialbasket","getproducts","pagesToCheck","console","log","getPageInformation","forEach","toCheck","then","v","data","fields","subcategory","product_in_subcategory","catch","e","clearBasket","finally","i","addObserver","callback","push","removeObserver","filter","o","notifyObservers","whatHappened","addToBasket","prod","size","amount","productthatexisted","produc","deepEqual","sizeselected","bask","productObject","amountorderd","length","combinedamount","localStorage","setItem","JSON","stringify","added","removeFromBasket","removed","addQuantatieOfProduct","change","changed","getTotalBasketprice","getBasket","price","reduce","a","product","product_price","Math","round","Number","EPSILON","isItemInBasket","link","page","retrieve","apiProducts","correctProducts","productinbasket","find","collecteditem","sortedBask","sort","b","product_name","getBasketItemNumber","modelString","getItem","modelObject","parse","storeModel","object1","object2","keys1","Object","keys","keys2","key","val1","val2","areObjects","isObject","object"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,iBAAP;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,MAAMC,MAAM,GAAGD,MAAM,CAAC,0CAAD,CAArB;;AACA,MAAME,UAAN,SAAyBH,KAAK,CAACI,SAA/B,CAAyC;AACvCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB;AACA,SAAKC,WAAL,GAAmB,EAAnB;AACA,SAAKC,KAAL,GAAa;AACXC,MAAAA,MAAM,EAAEH,KAAK,CAACG;AADH,KAAb;AAGA,SAAKC,aAAL,GAAqB,KAAKC,WAAL,EAArB;AACC;;AAEHA,EAAAA,WAAW,GAAE;AACX,QAAIC,YAAY,GAAG,CAAC,MAAD,CAAnB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,kBAAL,CAAwB,MAAxB,CAAZ;AACA;AACA,WAAO,CAAC,GAAGH,YAAY,CAACI,OAAb,CAAqBC,OAAO,IAAI;AACzCJ,MAAAA,OAAO,CAACC,GAAR,CAAYG,OAAZ;AACA,aAAO,CAAC,GAAG,KAAKF,kBAAL,CAAwBE,OAAxB,EAAiCC,IAAjC,CAAsCC,CAAC,IAAIA,CAAC,CAACC,IAAF,CAAOA,IAAP,CAAYC,MAAZ,CAAmBC,WAAnB,CAA+BC,sBAA1E,EAAkGC,KAAlG,CAAwGC,CAAC,IAAI;AAACZ,QAAAA,OAAO,CAACC,GAAR,CAAYW,CAAZ;AAAgB,aAAKC,WAAL;AAAmB,OAAjJ,EAAmJC,OAAnJ,CAA2JC,CAAC,IAAI;AACzKf,QAAAA,OAAO,CAACC,GAAR,CAAYc,CAAZ;AACE,OAFO,CAAJ,CAAP;AAGC,KALQ,CAAJ,CAAP;AASD;;AAEDC,EAAAA,WAAW,CAACC,QAAD,EAAW;AACpB,SAAKvB,WAAL,CAAiBwB,IAAjB,CAAsBD,QAAtB;AACD;;AAEDE,EAAAA,cAAc,CAACF,QAAD,EAAW;AACvBA,IAAAA,QAAQ,GAAG,KAAKvB,WAAL,CAAiB0B,MAAjB,CAAyBC,CAAD,IAAOA,CAAC,KAAKJ,QAArC,CAAX;AACD;;AAEDK,EAAAA,eAAe,CAACC,YAAD,EAAe;AAC5B,SAAK7B,WAAL,CAAiBS,OAAjB,CAAyB,UAAUc,QAAV,EAAoB;AAC3CA,MAAAA,QAAQ,CAACM,YAAD,CAAR;AACD,KAFD;AAGD;;AAEDC,EAAAA,WAAW,CAACC,IAAD,EAAOC,IAAI,GAAC,KAAZ,EAAmBC,MAAM,GAAC,CAA1B,EAA4B;AACrC,QAAIC,kBAAkB,GAAG,KAAKjC,KAAL,CAAWC,MAAX,CAAkBwB,MAAlB,CAAyBS,MAAM,IAAIC,SAAS,CAACD,MAAM,CAACJ,IAAR,EAAcA,IAAd,CAAT,IAAiCI,MAAM,CAACE,YAAP,KAAwBL,IAA5F,CAAzB;AACA,QAAIM,IAAI,GAAG,KAAKrC,KAAL,CAAWC,MAAX,CAAkBwB,MAAlB,CAAyBS,MAAM,IAAI,EAAEC,SAAS,CAACD,MAAM,CAACJ,IAAR,EAAcA,IAAd,CAAT,IAAiCI,MAAM,CAACE,YAAP,KAAwBL,IAA3D,CAAnC,CAAX;AACA,QAAIO,aAAa,GAAG;AAACR,MAAAA,IAAD;AAAQM,MAAAA,YAAY,EAACL,IAArB;AAA2BQ,MAAAA,YAAY,EAACP;AAAxC,KAApB;;AACA,QAAIC,kBAAkB,CAACO,MAAnB,KAA8B,CAAlC,EAAoC;AAClC,UAAIC,cAAc,GAAGT,MAAM,GAAGC,kBAAkB,CAAC,CAAD,CAAlB,CAAsBM,YAApD;AACAD,MAAAA,aAAa,GAAG;AAACR,QAAAA,IAAD;AAAQM,QAAAA,YAAY,EAACL,IAArB;AAA2BQ,QAAAA,YAAY,EAACE;AAAxC,OAAhB;AACD;;AACD,SAAKzC,KAAL,CAAWC,MAAX,GAAoB,CAAC,GAAGoC,IAAJ,EAAUC,aAAV,CAApB;AACAI,IAAAA,YAAY,CAACC,OAAb,CAAqB,mBAArB,EACIC,IAAI,CAACC,SAAL,CAAgB;AAAC5C,MAAAA,MAAM,EAAC,CAAC,GAAG,KAAKD,KAAL,CAAWC,MAAf;AAAR,KAAhB,CADJ;AAEI,SAAK0B,eAAL,CAAqB;AAACmB,MAAAA,KAAK,EAACR;AAAP,KAArB;AACL;;AAEDS,EAAAA,gBAAgB,CAACjB,IAAD,EAAMC,IAAN,EAAW;AACzB,QAAIM,IAAI,GAAG,KAAKrC,KAAL,CAAWC,MAAX,CAAkBwB,MAAlB,CAAyBS,MAAM,IAAI,EAAEC,SAAS,CAACD,MAAM,CAACJ,IAAR,EAAcA,IAAd,CAAT,IAAiCI,MAAM,CAACE,YAAP,KAAwBL,IAA3D,CAAnC,CAAX;AACA,SAAK/B,KAAL,CAAWC,MAAX,GAAoB,CAAC,GAAGoC,IAAJ,CAApB;AACAK,IAAAA,YAAY,CAACC,OAAb,CAAqB,mBAArB,EACIC,IAAI,CAACC,SAAL,CAAgB;AAAC5C,MAAAA,MAAM,EAAC,CAAC,GAAG,KAAKD,KAAL,CAAWC,MAAf;AAAR,KAAhB,CADJ;AAEI,SAAK0B,eAAL,CAAqB;AAACqB,MAAAA,OAAO,EAAClB;AAAT,KAArB;AACL;;AAEDmB,EAAAA,qBAAqB,CAACnB,IAAD,EAAOC,IAAP,EAAamB,MAAb,EAAoB;AACvC,QAAIjB,kBAAkB,GAAG,KAAKjC,KAAL,CAAWC,MAAX,CAAkBwB,MAAlB,CAAyBS,MAAM,IAAIC,SAAS,CAACD,MAAM,CAACJ,IAAR,EAAcA,IAAd,CAAT,IAAiCI,MAAM,CAACE,YAAP,KAAwBL,IAA5F,CAAzB;AACA,QAAIM,IAAI,GAAG,KAAKrC,KAAL,CAAWC,MAAX,CAAkBwB,MAAlB,CAAyBS,MAAM,IAAI,EAAEC,SAAS,CAACD,MAAM,CAACJ,IAAR,EAAcA,IAAd,CAAT,IAAiCI,MAAM,CAACE,YAAP,KAAwBL,IAA3D,CAAnC,CAAX;AACA,QAAIO,aAAa,GAAG;AAACR,MAAAA,IAAD;AAAQM,MAAAA,YAAY,EAACL,IAArB;AAA2BQ,MAAAA,YAAY,EAAC;AAAxC,KAApB;AACA,QAAIE,cAAc,GAAG,CAArB;;AACA,QAAIR,kBAAkB,CAACO,MAAnB,KAA8B,CAAlC,EAAoC;AAChCC,MAAAA,cAAc,GAAGR,kBAAkB,CAAC,CAAD,CAAlB,CAAsBM,YAAtB,GAAqCW,MAAtD;;AACF,UAAIT,cAAD,IAAoB,CAAvB,EAA0B;AACxBA,QAAAA,cAAc,GAAG,CAAjB;AACD;;AACDH,MAAAA,aAAa,GAAG;AAACR,QAAAA,IAAD;AAAQM,QAAAA,YAAY,EAACL,IAArB;AAA2BQ,QAAAA,YAAY,EAACE;AAAxC,OAAhB;AACD;;AACD,SAAKzC,KAAL,CAAWC,MAAX,GAAoB,CAAC,GAAGoC,IAAJ,EAAUC,aAAV,CAApB;AACAI,IAAAA,YAAY,CAACC,OAAb,CAAqB,mBAArB,EACIC,IAAI,CAACC,SAAL,CAAgB;AAAC5C,MAAAA,MAAM,EAAC,CAAC,GAAG,KAAKD,KAAL,CAAWC,MAAf;AAAR,KAAhB,CADJ;AAGI,SAAK0B,eAAL,CAAqB;AAACwB,MAAAA,OAAO,EAACrB;AAAT,KAArB;AACL;;AAGAZ,EAAAA,WAAW,GAAE;AACZ,SAAKlB,KAAL,CAAWC,MAAX,GAAoB,EAApB;AACAI,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKN,KAAjB;AAEA0C,IAAAA,YAAY,CAACC,OAAb,CAAqB,mBAArB,EAA0CC,IAAI,CAACC,SAAL,CAAe;AAAC5C,MAAAA,MAAM,EAAC;AAAR,KAAf,CAA1C;AAED;;AAEDmD,EAAAA,mBAAmB,GAAE;AACnB,QAAInD,MAAM,GAAI,KAAKoD,SAAL,EAAd;AACA,QAAIC,KAAK,GAAGrD,MAAM,CAACsD,MAAP,CAAc,CAACC,CAAD,EAAIC,OAAJ,KAAgBD,CAAC,IAAKC,OAAO,CAAC3B,IAAR,CAAa4B,aAAb,GAA6BD,OAAO,CAAClB,YAAzE,EAAwF,CAAxF,CAAZ;AAEA,WAAOoB,IAAI,CAACC,KAAL,CAAW,CAACN,KAAK,GAAGO,MAAM,CAACC,OAAhB,IAA2B,GAAtC,IAA6C,GAApD;AAED;;AAEDC,EAAAA,cAAc,CAACjC,IAAD,EAAOC,IAAP,EAAY;AACxB,QAAIE,kBAAkB,GAAG,KAAKjC,KAAL,CAAWC,MAAX,CAAkBwB,MAAlB,CAAyBS,MAAM,IAAIC,SAAS,CAACD,MAAM,CAACJ,IAAR,EAAcA,IAAd,CAAT,IAAiCI,MAAM,CAACE,YAAP,KAAwBL,IAA5F,CAAzB;;AACA,QAAGE,kBAAkB,CAACO,MAAnB,KAA8B,CAAjC,EAAmC;AACjC,aAAO,KAAP;AACD,KAFD,MAGI;AAAC,aAAO,IAAP;AAAY;AAElB;;AAED,QAAMjC,kBAAN,CAAyByD,IAAzB,EAA+B;AAC7B,WAAO,MAAMtE,MAAM,CAACuE,IAAP,CAAYC,QAAZ,CAAqB,GAArB,EAA0B,KAAGF,IAAH,GAAS,EAAnC,CAAb;AAEC;;AAEHX,EAAAA,SAAS,GAAE;AACT,QAAIc,WAAW,GAAG,CAAC,GAAI,KAAKjE,aAAV,CAAlB;AACA,QAAIkE,eAAe,GAAG,EAAtB;AACA,QAAInE,MAAM,GAAG,CAAC,GAAG,KAAKD,KAAL,CAAWC,MAAf,CAAb;AACAA,IAAAA,MAAM,CAACO,OAAP,CAAe6D,eAAe,IAAG;AAAEhE,MAAAA,OAAO,CAACC,GAAR,CAAY+D,eAAe,CAACvC,IAA5B;AAAmCzB,MAAAA,OAAO,CAACC,GAAR,CAAY8D,eAAZ;AAA+BA,MAAAA,eAAe,GAAC,CAAC,GAAGA,eAAJ,EAAoB;AAAChC,QAAAA,YAAY,EAAEiC,eAAe,CAACjC,YAA/B;AAA4CG,QAAAA,YAAY,EAAE8B,eAAe,CAAC9B,YAA1E;AAAyFT,QAAAA,IAAI,EAAEqC,WAAW,CAACG,IAAZ,CAAiBC,aAAa,IAAI,CAACpC,SAAS,CAACkC,eAAe,CAACvC,IAAjB,EAAwByC,aAAxB,CAA5C;AAA/F,OAApB,CAAhB;AAA2N,KAAhU;AAEA,QAAIC,UAAU,GAAGvE,MAAM,CAACwE,IAAP,CAAY,CAACjB,CAAD,EAAGkB,CAAH,KAAS;AACpC,UAAGlB,CAAC,CAAC1B,IAAF,CAAO6C,YAAP,GAAsBD,CAAC,CAAC5C,IAAF,CAAO6C,YAAhC,EAA6C;AACzC,eAAO,CAAC,CAAR;AACD;;AACH,UAAGnB,CAAC,CAAC1B,IAAF,CAAO6C,YAAP,GAAsBD,CAAC,CAAC5C,IAAF,CAAO6C,YAAhC,EAA6C;AACzC,eAAO,CAAC,CAAR;AACD,OAFH,MAGI;AACA,eAAO,CAAP;AACD;AACF,KAVc,CAAjB;AAYF,WAAOH,UAAP;AAGC;;AAEDI,EAAAA,mBAAmB,GAAE;AAEnB,WAAO,KAAK5E,KAAL,CAAWC,MAAX,CAAkBuC,MAAzB;AACD;;AAzIsC;;AA4IzC,MAAMqC,WAAW,GAAEnC,YAAY,CAACoC,OAAb,CAAqB,mBAArB,CAAnB;AACA,IAAIC,WAAW,GAAEnC,IAAI,CAACoC,KAAL,CAAWH,WAAX,CAAjB;AACAE,WAAW,GAAC1E,OAAO,CAACC,GAAR,CAAY,oBAAZ,CAAD,GAAoCyE,WAAW,GAAE;AAAC9E,EAAAA,MAAM,EAAC;AAAR,CAA5D;AACA,MAAMgF,UAAU,GAAG,IAAItF,UAAJ,CAAeoF,WAAf,CAAnB;AACA,eAAeE,UAAf;;AAEA,SAAS9C,SAAT,CAAmB+C,OAAnB,EAA4BC,OAA5B,EAAqC;AACnC,QAAMC,KAAK,GAAGC,MAAM,CAACC,IAAP,CAAYJ,OAAZ,CAAd;AACA,QAAMK,KAAK,GAAGF,MAAM,CAACC,IAAP,CAAYH,OAAZ,CAAd;;AAEA,MAAIC,KAAK,CAAC5C,MAAN,KAAiB+C,KAAK,CAAC/C,MAA3B,EAAmC;AACjC,WAAO,KAAP;AACD;;AAED,OAAK,MAAMgD,GAAX,IAAkBJ,KAAlB,EAAyB;AACvB,UAAMK,IAAI,GAAGP,OAAO,CAACM,GAAD,CAApB;AACA,UAAME,IAAI,GAAGP,OAAO,CAACK,GAAD,CAApB;AACA,UAAMG,UAAU,GAAGC,QAAQ,CAACH,IAAD,CAAR,IAAkBG,QAAQ,CAACF,IAAD,CAA7C;;AACA,QACEC,UAAU,IAAI,CAACxD,SAAS,CAACsD,IAAD,EAAOC,IAAP,CAAxB,IACA,CAACC,UAAD,IAAeF,IAAI,KAAKC,IAF1B,EAGE;AACA,aAAO,KAAP;AACD;AACF;;AAED,SAAO,IAAP;AACD;;AAED,SAASE,QAAT,CAAkBC,MAAlB,EAA0B;AACxB,SAAOA,MAAM,IAAI,IAAV,IAAkB,OAAOA,MAAP,KAAkB,QAA3C;AACD","sourcesContent":["import React from \"react\";\nimport '../butterclient';\nimport Butter from 'buttercms';\nconst butter = Butter('2fa7babaa7064c23b2cb90171957b2add0333e77');\nclass StoreModel extends React.Component {\n  constructor(props) {\n    super();\n    this.subscribers = [];\n    this.state = {\n      basket: props.basket\n    };\n    this.initialbasket = this.getproducts();\n    }\n  \n  getproducts(){\n    let pagesToCheck = [\"shop\"];\n    console.log(this.getPageInformation(\"shop\"));\n    debugger;\n    return [...pagesToCheck.forEach(toCheck => {\n      console.log(toCheck);\n      return [...this.getPageInformation(toCheck).then(v => v.data.data.fields.subcategory.product_in_subcategory).catch(e => {console.log(e); this.clearBasket()}).finally(i => { \n        console.log(i); \n         }) ]\n      })] \n\n\n\n  }\n\n  addObserver(callback) {\n    this.subscribers.push(callback);\n  }\n\n  removeObserver(callback) {\n    callback = this.subscribers.filter((o) => o !== callback);\n  }\n\n  notifyObservers(whatHappened) {\n    this.subscribers.forEach(function (callback) {\n      callback(whatHappened);\n    });\n  }\n\n  addToBasket(prod, size=\"n/a\", amount=1){\n    let productthatexisted = this.state.basket.filter(produc => deepEqual(produc.prod, prod) && (produc.sizeselected === size));\n    let bask = this.state.basket.filter(produc => !(deepEqual(produc.prod, prod) && (produc.sizeselected === size)));\n    let productObject = {prod , sizeselected:size, amountorderd:amount }\n    if (productthatexisted.length !== 0){\n      let combinedamount = amount + productthatexisted[0].amountorderd \n      productObject = {prod , sizeselected:size, amountorderd:combinedamount}\n    }\n    this.state.basket = [...bask, productObject];\n    localStorage.setItem(\"The_coolest_store\", \n        JSON.stringify( {basket:[...this.state.basket]}))\n        this.notifyObservers({added:productObject});\n  }\n\n  removeFromBasket(prod,size){\n    let bask = this.state.basket.filter(produc => !(deepEqual(produc.prod, prod) && (produc.sizeselected === size)));\n    this.state.basket = [...bask];\n    localStorage.setItem(\"The_coolest_store\", \n        JSON.stringify( {basket:[...this.state.basket]}))\n        this.notifyObservers({removed:prod});\n  }\n\n  addQuantatieOfProduct(prod, size, change){\n    let productthatexisted = this.state.basket.filter(produc => deepEqual(produc.prod, prod) && (produc.sizeselected === size));\n    let bask = this.state.basket.filter(produc => !(deepEqual(produc.prod, prod) && (produc.sizeselected === size)));\n    let productObject = {prod , sizeselected:size, amountorderd:1 }\n    let combinedamount = 1\n    if (productthatexisted.length !== 0){\n        combinedamount = productthatexisted[0].amountorderd + change;\n      if((combinedamount) <= 1 ){\n        combinedamount = 1;\n      }\n      productObject = {prod , sizeselected:size, amountorderd:combinedamount}\n    }\n    this.state.basket = [...bask, productObject];\n    localStorage.setItem(\"The_coolest_store\", \n        JSON.stringify( {basket:[...this.state.basket]}))\n\n        this.notifyObservers({changed:prod});\n  }\n  \n\n   clearBasket(){\n    this.state.basket = [];\n    console.log(this.state);\n    \n    localStorage.setItem(\"The_coolest_store\", JSON.stringify({basket:[]}))\n  \n  }\n\n  getTotalBasketprice(){\n    let basket  = this.getBasket();\n    let price = basket.reduce((a, product) => a += (product.prod.product_price * product.amountorderd) ,0)\n    \n    return Math.round((price + Number.EPSILON) * 100) / 100\n\n  }\n\n  isItemInBasket(prod, size){\n    let productthatexisted = this.state.basket.filter(produc => deepEqual(produc.prod, prod) && (produc.sizeselected === size));\n    if(productthatexisted.length !== 0){\n      return false\n    }\n    else{return true}\n  \n  }\n\n  async getPageInformation(link) {\n    return await butter.page.retrieve('*', ''+link +'');\n \n    }\n\n  getBasket(){\n    let apiProducts = [... this.initialbasket];\n    let correctProducts = []\n    let basket = [...this.state.basket];\n    basket.forEach(productinbasket =>{ console.log(productinbasket.prod); console.log(correctProducts);  correctProducts=[...correctProducts,{sizeselected: productinbasket.sizeselected,amountorderd: productinbasket.amountorderd , prod: apiProducts.find(collecteditem => !deepEqual(productinbasket.prod , collecteditem))}]; })\n        \n    let sortedBask = basket.sort((a,b) => {\n      if(a.prod.product_name > b.prod.product_name){\n          return +1\n        }\n      if(a.prod.product_name < b.prod.product_name){\n          return -1\n        }\n      else{\n          return 0\n        }\n      }); \n  \n  return sortedBask;\n\n   \n  }\n\n  getBasketItemNumber(){\n    \n    return this.state.basket.length;\n  }\n}\n\nconst modelString= localStorage.getItem(\"The_coolest_store\");\nlet modelObject= JSON.parse(modelString);\nmodelObject?console.log(\"User data detected\"): modelObject= {basket:[]}\nconst storeModel = new StoreModel(modelObject);\nexport default storeModel;\n\nfunction deepEqual(object1, object2) {\n  const keys1 = Object.keys(object1);\n  const keys2 = Object.keys(object2);\n\n  if (keys1.length !== keys2.length) {\n    return false;\n  }\n\n  for (const key of keys1) {\n    const val1 = object1[key];\n    const val2 = object2[key];\n    const areObjects = isObject(val1) && isObject(val2);\n    if (\n      areObjects && !deepEqual(val1, val2) ||\n      !areObjects && val1 !== val2\n    ) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isObject(object) {\n  return object != null && typeof object === 'object';\n}\n"]},"metadata":{},"sourceType":"module"}